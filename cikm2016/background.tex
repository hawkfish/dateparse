\subsection{The ICU Date Format Language}

The choice of a date format syntax for generation is somewhat arbitrary, but for the purposes of exposition we will be using the formatting language defined by the ICU open-source project~\cite{ICU}. We chose this format because we were already using ICU in our system, we had access to the source code, and it provides localized date part data for a large number of languages (\eg month names). ICU's format syntax is typical of most syntax languages and provides a large number of date part codes, and a summary of it is reproduced in Table 2. The complete syntax is documented at the ICU web site.  Other syntaxes can either be generated directly from the algorithms, or by translating the ICU syntax into into the desired syntax. (In fact, this latter approach is how our visualization system internally generates formats for RDBMSes that have non-ICU syntax.)

\begin{table}[ht]
\centering
\bgroup
\def\arraystretch{1.5}
\begin{tabular}{|p{0.15\linewidth}| p{0.5\linewidth}|}
\hline
\textbf{ICU Code} & \textbf{Interpretation}\\ \hline

\scriptsize{yy} & \scriptsize{year (96)}\\ \hline
\scriptsize{yyyy} & \scriptsize{year (1996)}\\ \hline
    
\scriptsize{QQ} & \scriptsize{quarter (02)}\\ \hline
\scriptsize{QQQ} & \scriptsize{quarter (Q2)}\\ \hline
\scriptsize{QQQQ} & \scriptsize{quarter (2nd quarter)}\\ \hline
    
\scriptsize{MM} & \scriptsize{month in year (09)}\\ \hline
\scriptsize{MMM} & \scriptsize{month in year (Sept)}\\ \hline
\scriptsize{MMMM} & \scriptsize{month in year (September)}\\ \hline
    
\scriptsize{dd} & \scriptsize{day in month (02)}\\ \hline
    
\scriptsize{EEE} & \scriptsize{day of week (Tues)}\\ \hline
\scriptsize{EEEE} & \scriptsize{day of week (Tuesday)}\\ \hline
    
\scriptsize{a} & \scriptsize{am/pm marker (pm)}\\ \hline
    
\scriptsize{hh} & \scriptsize{hour in am/pm 1:12 (07)}\\ \hline
\scriptsize{HH} & \scriptsize{hour in day 0:23 (00)}\\ \hline
\scriptsize{mm} & \scriptsize{minute in hour (04)}\\ \hline
\scriptsize{ss} & \scriptsize{second in minute (05)}\\ \hline
    
\scriptsize{S} & \scriptsize{millisecond (2)}\\ \hline
\scriptsize{SS} & \scriptsize{millisecond (23)}\\ \hline
\scriptsize{SSS} & \scriptsize{millisecond (235)}\\ \hline

\scriptsize{zzz} & \scriptsize{Time Zone: specific non-location (PDT)}\\ \hline

\scriptsize{Z} & \scriptsize{Time Zone: RFC 822 (-0800)}\\ \hline
\scriptsize{ZZZZ} & \scriptsize{Time Zone: localized GMT (GMT-08:00)}\\ \hline
\scriptsize{ZZZZZ} & \scriptsize{Time Zone: ISO8601 (-08:00)}\\ \hline
    
\scriptsize{'} & \scriptsize{escape for text (nothing)}\\ \hline
\scriptsize{''} & \scriptsize{two single quotes produce one (')}\\ \hline

\end{tabular}
\egroup
\label{tab:icuformats} \\
\caption{ICU Format Codes.}
\end{table}

While fairly extensive, the ICU syntax has a few limitations when working with real-world data:

\begin{itemize}
\setlength\itemsep{0em}
\item No support for 4 letter month abbreviations (\eg \texttt{Sept.})
\item No support for ordinal days (\eg \texttt{July 4th})
\item No support for quarter postfix notation (\eg \texttt{2Q})
\item No support for variant meridian markers (\eg \texttt{a.m.})
\end{itemize}

These limitations did not affect the results significantly, and in the future we hope to submit ICU extensions to handle some of these formats. Moreover, all the languages we examined had their own limitations, so ICU is not unusual in this respect.

One other quirk of the ICU syntax may be a contributing factor to the observed user difficulties writing correct ICU date formats in our visualization system. The use of lexicographical case in the meta-symbols of the format language can be confusing (\eg \texttt{y} is used for years, but \texttt{M} is used for months while \texttt{m} is used for minutes. A better design would have made case more consistent within dates and times. Another advantage of automated syntax generation is that it hides such problems from most users, significantly improving the usability of the function.

\subsection{The \dateparse\ Function}

The date format generated by the algorithms is presumed to be a string argument to a scalar function called \dateparse, which converts a string value to a date value using the format string. Several examples of this kind of function can be found in RDBMSes such as MySQL's \functionname{STR_TO_DATE}, Oracle's \functionname{TO_TIMESTAMP} and Postgres' \functionname{TO_TIMESTAMP}. There are also programming language library implementations such as Python's \functionname{strptime} and ICU's own \functionname{DateFormat::parse}.
